{
  "content": "aW1wb3J0IFN3aWZ0VUkKCnN0cnVjdCBDS0J1dHRvbjogVmlldyB7CiAgICBsZXQgdGl0bGU6IFN0cmluZwogICAgbGV0IGljb246IFN0cmluZz8KICAgIGxldCBzdHlsZTogQnV0dG9uU3R5bGUKICAgIGxldCBhY3Rpb246ICgpIC0+IFZvaWQKICAgIAogICAgZW51bSBCdXR0b25TdHlsZSB7CiAgICAgICAgY2FzZSBwcmltYXJ5CiAgICAgICAgY2FzZSBzZWNvbmRhcnkKICAgICAgICBjYXNlIGdob3N0CiAgICAgICAgCiAgICAgICAgdmFyIGJhY2tncm91bmRDb2xvcjogQ29sb3IgewogICAgICAgICAgICBzd2l0Y2ggc2VsZiB7CiAgICAgICAgICAgIGNhc2UgLnByaW1hcnk6CiAgICAgICAgICAgICAgICByZXR1cm4gQ29sb3IoIkFjY2VudENvbG9yIikKICAgICAgICAgICAgY2FzZSAuc2Vjb25kYXJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIENvbG9yLmdyYXkub3BhY2l0eSgwLjEpCiAgICAgICAgICAgIGNhc2UgLmdob3N0OgogICAgICAgICAgICAgICAgcmV0dXJuIENvbG9yLmNsZWFyCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdmFyIGZvcmVncm91bmRDb2xvcjogQ29sb3IgewogICAgICAgICAgICBzd2l0Y2ggc2VsZiB7CiAgICAgICAgICAgIGNhc2UgLnByaW1hcnk6CiAgICAgICAgICAgICAgICByZXR1cm4gLndoaXRlCiAgICAgICAgICAgIGNhc2UgLnNlY29uZGFyeSwgLmdob3N0OgogICAgICAgICAgICAgICAgcmV0dXJuIENvbG9yKCJBY2NlbnRDb2xvciIpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdmFyIGJvcmRlckNvbG9yOiBDb2xvciB7CiAgICAgICAgICAgIHN3aXRjaCBzZWxmIHsKICAgICAgICAgICAgY2FzZSAuZ2hvc3Q6CiAgICAgICAgICAgICAgICByZXR1cm4gQ29sb3IoIkFjY2VudENvbG9yIikKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiAuY2xlYXIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgaW5pdCgKICAgICAgICBfIHRpdGxlOiBTdHJpbmcsCiAgICAgICAgaWNvbjogU3RyaW5nPyA9IG5pbCwKICAgICAgICBzdHlsZTogQnV0dG9uU3R5bGUgPSAucHJpbWFyeSwKICAgICAgICBhY3Rpb246IEBlc2NhcGluZyAoKSAtPiBWb2lkCiAgICApIHsKICAgICAgICBzZWxmLnRpdGxlID0gdGl0bGUKICAgICAgICBzZWxmLmljb24gPSBpY29uCiAgICAgICAgc2VsZi5zdHlsZSA9IHN0eWxlCiAgICAgICAgc2VsZi5hY3Rpb24gPSBhY3Rpb24KICAgIH0KICAgIAogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgQnV0dG9uKGFjdGlvbjogYWN0aW9uKSB7CiAgICAgICAgICAgIEhTdGFjayhzcGFjaW5nOiA4KSB7CiAgICAgICAgICAgICAgICBpZiBsZXQgaWNvbiA9IGljb24gewogICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6IGljb24pCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5zeXN0ZW0oc2l6ZTogMTYsIHdlaWdodDogLm1lZGl1bSkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFRleHQodGl0bGUpCiAgICAgICAgICAgICAgICAgICAgLmZvbnQoLnN5c3RlbShzaXplOiAxNiwgd2VpZ2h0OiAuc2VtaWJvbGQpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5mcmFtZShtYXhXaWR0aDogLmluZmluaXR5KQogICAgICAgICAgICAucGFkZGluZygudmVydGljYWwsIDEyKQogICAgICAgICAgICAucGFkZGluZyguaG9yaXpvbnRhbCwgMTYpCiAgICAgICAgICAgIC5iYWNrZ3JvdW5kKHN0eWxlLmJhY2tncm91bmRDb2xvcikKICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcihzdHlsZS5mb3JlZ3JvdW5kQ29sb3IpCiAgICAgICAgICAgIC5jb3JuZXJSYWRpdXMoMTIpCiAgICAgICAgICAgIC5vdmVybGF5KAogICAgICAgICAgICAgICAgUm91bmRlZFJlY3RhbmdsZShjb3JuZXJSYWRpdXM6IDEyKQogICAgICAgICAgICAgICAgICAgIC5zdHJva2Uoc3R5bGUuYm9yZGVyQ29sb3IsIGxpbmVXaWR0aDogMSkKICAgICAgICAgICAgKQogICAgICAgIH0KICAgIH0KfQoKLy8gSWNvbiBCdXR0b24gdmFyaWFudApzdHJ1Y3QgQ0tJY29uQnV0dG9uOiBWaWV3IHsKICAgIGxldCBpY29uOiBTdHJpbmcKICAgIGxldCBzdHlsZTogQ0tCdXR0b24uQnV0dG9uU3R5bGUKICAgIGxldCBhY3Rpb246ICgpIC0+IFZvaWQKICAgIAogICAgaW5pdCgKICAgICAgICBpY29uOiBTdHJpbmcsCiAgICAgICAgc3R5bGU6IENLQnV0dG9uLkJ1dHRvblN0eWxlID0gLnByaW1hcnksCiAgICAgICAgYWN0aW9uOiBAZXNjYXBpbmcgKCkgLT4gVm9pZAogICAgKSB7CiAgICAgICAgc2VsZi5pY29uID0gaWNvbgogICAgICAgIHNlbGYuc3R5bGUgPSBzdHlsZQogICAgICAgIHNlbGYuYWN0aW9uID0gYWN0aW9uCiAgICB9CiAgICAKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIEJ1dHRvbihhY3Rpb246IGFjdGlvbikgewogICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiBpY29uKQogICAgICAgICAgICAgICAgLmZvbnQoLnN5c3RlbShzaXplOiAyMCwgd2VpZ2h0OiAubWVkaXVtKSkKICAgICAgICAgICAgICAgIC5mcmFtZSh3aWR0aDogNDQsIGhlaWdodDogNDQpCiAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChzdHlsZS5iYWNrZ3JvdW5kQ29sb3IpCiAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKHN0eWxlLmZvcmVncm91bmRDb2xvcikKICAgICAgICAgICAgICAgIC5jb3JuZXJSYWRpdXMoMTIpCiAgICAgICAgICAgICAgICAub3ZlcmxheSgKICAgICAgICAgICAgICAgICAgICBSb3VuZGVkUmVjdGFuZ2xlKGNvcm5lclJhZGl1czogMTIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHJva2Uoc3R5bGUuYm9yZGVyQ29sb3IsIGxpbmVXaWR0aDogMSkKICAgICAgICAgICAgICAgICkKICAgICAgICB9CiAgICB9Cn0KCiNQcmV2aWV3IHsKICAgIFZTdGFjayhzcGFjaW5nOiAyMCkgewogICAgICAgIENLQnV0dG9uKCJQcmltYXJ5IEJ1dHRvbiIsIGljb246ICJwbHVzIikge30KICAgICAgICBDS0J1dHRvbigiU2Vjb25kYXJ5IEJ1dHRvbiIsIGljb246ICJzdGFyIiwgc3R5bGU6IC5zZWNvbmRhcnkpIHt9CiAgICAgICAgQ0tCdXR0b24oIkdob3N0IEJ1dHRvbiIsIHN0eWxlOiAuZ2hvc3QpIHt9CiAgICAgICAgCiAgICAgICAgSFN0YWNrKHNwYWNpbmc6IDEyKSB7CiAgICAgICAgICAgIENLSWNvbkJ1dHRvbihpY29uOiAiaGVhcnQiKSB7fQogICAgICAgICAgICBDS0ljb25CdXR0b24oaWNvbjogImJvb2ttYXJrIiwgc3R5bGU6IC5zZWNvbmRhcnkpIHt9CiAgICAgICAgICAgIENLSWNvbkJ1dHRvbihpY29uOiAic3F1YXJlLmFuZC5hcnJvdy51cCIsIHN0eWxlOiAuZ2hvc3QpIHt9CiAgICAgICAgfQogICAgfQogICAgLnBhZGRpbmcoKQp9",
  "encoding": "base64"
}